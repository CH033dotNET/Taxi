@model IEnumerable<Model.DTO.OrderDTO>
@{
    ViewBag.Title = "Orders";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!--
    Messages
-->
<script src="~/Scripts/jquery-1.8.2.min.js"></script>
<script src="~/Scripts/jquery.signalR-2.2.0.min.js"></script>


<div class="main">
    <input id="txtRoleId" type="hidden" value="@((Session["User"] as Model.DTO.UserDTO).RoleId)" />

    <div id="chatBody">
        <div id="inputForm">
            <input type="text" id="message" />
            <input type="button" id="sendmessage" value="Send a message to Drivers" />
        </div>
    </div>
</div>


<script src="~/signalr/hubs"></script>


<!--
    End messages
-->


@* New orders table *@
<h2 class="OperatortbNames">@Resources.Resource.NewOrders</h2>
<script id="orderTemplate" type="text/x-handlebars-template">
    <table class="table table-hover">
        <thead>
            <tr class="historyTh">
                <th>@Resources.Resource.Name</th>
                <th>@Resources.Resource.PeekPlace</th>
                <th>@Resources.Resource.DropPlace</th>
                <th>@Resources.Resource.OrderTime</th>
                <th>@Resources.Resource.Action</th>
            </tr>
        </thead>
        <tbody>
            {{#each objects}}
            <tr>
                <td>{{FirsName}}</td>
                <td>{{PeekPlace}}</td>
                <td>{{DropPlace}}</td>
                <td>{{PrettifyDate OrderTime}}</td>
                <td>
                    <button class="btn btn-success" data-orderid="{{OrderId}}" data-status="1" id="submitOrdering" onclick="setOrderStatus(this)">@Resources.Resource.Confirm</button>
                    <button class="btn btn-danger" data-orderid="{{OrderId}}" data-status="2" id="deniedOrdering" onclick="setOrderStatus(this)">@Resources.Resource.Denied</button>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</script>
<div id="orderContent"></div>

@* Waiting Orders *@
<h2 class="OperatortbNames">@Resources.Resource.WaitingOrders</h2>
<script id="waitingOrderTemplate" type="text/x-handlebars-template">
    <table class="table table-hover">
        <thead>
            <tr class="historyTh">
                <th>@Resources.Resource.Name</th>
                <th>@Resources.Resource.PeekPlace</th>
                <th>@Resources.Resource.DropPlace</th>
                <th>@Resources.Resource.OrderTime</th>
                <th>@Resources.Resource.Action</th>
            </tr>
        </thead>
        <tbody>
            {{#each waitingOrders}}
            <tr>
                <td>{{FirsName}}</td>
                <td>{{PeekPlace}}</td>
                <td>{{DropPlace}}</td>
                <td>{{PrettifyDate OrderTime}}</td>
                <td>
                    <button class="btn btn-danger" data-orderid="{{OrderId}}" data-status="5" id="waitingOrders" onclick="setOrderStatus(this)">@Resources.Resource.Denied</button>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</script>
<div id="waitingOrdersContent"></div>



@* DriverRequest table *@
<h2 class="OperatortbNames">@Resources.Resource.ConfirmedByDrivers</h2>
<script id="driverRequestTemplate" type="text/x-handlebars-template">
    <table class="table table-hover">
        <thead>
            <tr class="historyTh">
                <th>@Resources.Resource.PeekPlace</th>
                <th>@Resources.Resource.DropPlace</th>
                <th>@Resources.Resource.WaitingTime</th>
                <th>@Resources.Resource.Driver</th>
                <th>@Resources.Resource.Action</th>
            </tr>
        </thead>
        <tbody>
            {{#each requests}}
            <tr>
                <td>{{PeekPlace}}</td>
                <td>{{DropPlace}}</td>
                <td>{{WaitingTime}}</td>
                <td>{{DriverId}}</td>
                <td>
                    <button class="btn btn-success" data-orderid="{{OrderId}}" data-status="4" id="submitDrRequest" onclick="setOrderStatus(this)">@Resources.Resource.Confirm</button>
                    <button class="btn btn-danger" data-orderid="{{OrderId}}" data-status="2" id="deniedDrRequest" onclick="setOrderStatus(this)">@Resources.Resource.Denied</button>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</script>
<div id="driverRequest"></div>


<script src="~/Scripts/HandlebarsCustomHelpers.js"></script>
<script type="text/javascript" src="~/Scripts/OperatorCommand/OperatorCommands.js"></script>
<link href="~/Content/BootstrapTb/BootstrapTb.css" rel="stylesheet" />